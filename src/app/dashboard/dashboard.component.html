<div class="flex column">
  <div class="container info-col">
    <div class="patient-bar no-margin">
      <div class="black-text flex row">
        <div class="flex column" style="justify-content: center; align-items: center;">
          <img src="{{userInfo.profile_picture}}" id="profile-picture" class="circle responsive-img" style="box-shadow: 0px 0px 20px -2px #424242;"/>
          <span class="main-info">{{ userInfo.email }}</span>
          <span class="main-info">Homme</span>
        </div>
        <div style="width: 20px"></div>
        <div class="flex column full-width">
          <div class="card-title" style="display: flex; margin-bottom: 6px;">
            <span style="flex-grow: 1; margin-top: 4px;">{{ userInfo.first_name }} {{ userInfo.last_name | uppercase }}</span>
            <a class="waves-effect waves-light btn topbar-button" style="margin-right: 5px;" (click)="saveChanges()">
              <i class="material-icons left" style="margin-right: 10px;">save</i>
              Sauvegarder
            </a>
            <button mat-icon-button [matMenuTriggerFor]="patientOptionsMenu" style="width: 32px; height: 32px;">
              <mat-icon style="margin-bottom: 8px;">more_vert</mat-icon>
            </button>
            <mat-menu #patientOptionsMenu="matMenu" xPosition="before">
              <button mat-menu-item disabled>Envoyer un message</button>
              <button mat-menu-item (click)="deleteConnection()">Archiver le patient</button>
            </mat-menu>
          </div>
          <div class="simple-small-div"></div>
          <div class="row flex">
            <div class="column flex info-col">
              <p class="biometric-info">Poids (kg):</p>
              <input class="info-input" [(ngModel)]="userInfo.biometrics.mass"/>
              <p class="biometric-info">Taille (cm):</p>
              <input class="info-input" [(ngModel)]="userInfo.biometrics.height"/>
            </div>
            <div class="column flex info-col">
              <p class="biometric-info">Né le:</p>
              <input class="info-input" value="{{userInfo.biometrics.date_of_birth}}" disabled/>
              <p class="biometric-info">Type de diabète:</p>
              <input class="info-input" value="Type 1" disabled/>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="container tab-container full-width">
    <mat-tab-group mat-stretch-tabs class="main-tabs">
      <mat-tab label="Glycémies">
        <div class="tab-div" style="flex-direction: column;">
          <div class="card full-width-card white" style="margin-top: 0;">
            <div class="card-content black-text">
              <div class="card-title" style="display: flex; margin-bottom: 6px;">
                <span style="flex-grow: 1; margin-top: 4px;">Statistiques</span>
                <a class="waves-effect waves-light btn topbar-button" style="margin-right: 5px;" (click)="addHb()">
                  <i class="material-icons left" style="margin-right: 10px;">add</i>
                  Sélectionner une date
                </a>
                <select class="browser-default" style="width: 20%; font-size: 14px; height: 32px; border-radius: 16px;">
                  <option value="1">1 jour</option>
                  <option value="2">1 semaine</option>
                  <option value="3" selected>1 mois</option>
                  <option value="4">3 mois</option>
                  <option value="5">6 mois</option>
                  <option value="6">1 an</option>
                </select>
              </div>
              <div class="simple-small-div"></div>
              <div class="stats-container">
                <div class="stat-container">
                  <span class="stat-title">Hypoglycémies</span>
                  <span class="stat-number">{{userInfo.biometrics.hypoglycemia}}</span>
                </div>
                <div class="simple-small-div-vert"></div>
                <div class="stat-container">
                  <span class="stat-title">Hyperglycémies</span>
                  <span class="stat-number">{{userInfo.biometrics.hyperglycemia}}</span>
                </div>
                <div class="simple-small-div-vert"></div>
                <div class="stat-container">
                  <span class="stat-title">Utilisations capteur</span>
                  <span class="stat-number">0</span>
                </div>
              </div>
            </div>
          </div>
          <div class="card full-width-card white" style="margin-top: 0;">
            <div class="card-content black-text">
              <span class="card-title" style="margin-bottom: 0;">Taux de glycémie</span>
              <div class="simple-small-div"></div>
              <canvas baseChart height="85"
                [datasets]="bsChartData"
                [labels]="bsChartLabels"
                [options]="bsChartOptions"
                [legend]="bsChartLegend"
                [chartType]="bsChartType">
              </canvas>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab label="Notes">
        <div class="tab-div">
          <div class="card full-width-card white" style="margin-top: 0;">
            <div class="card-content black-text">
              <div class="card-title" style="display: flex; margin-bottom: 6px;">
                <span style="flex-grow: 1; margin-top: 4px;">Notes</span>
                <a class="waves-effect waves-light btn topbar-button" style="margin-right: 5px;" (click)="addNote()">
                  <i class="material-icons left" style="margin-right: 10px;">add</i>
                  Ajouter une note
                </a>
              </div>
              <div class="simple-small-div"></div>
              <div class="note-container" cdkDropListGroup>
                <div cdkDropList (cdkDropListDropped)="dropListDropped($event)" [cdkDropListEnterPredicate]="dropListEnterPredicate"></div>
                <div cdkDropList *ngFor="let note of userInfo.notes" [cdkDropListEnterPredicate]="dropListEnterPredicate"
                    (cdkDropListDropped)="dropListDropped($event)">
                  <div cdkDrag class="note-box" (cdkDragMoved)="dragMoved($event);">
                    <div style="height: 100%; width: 5px;" [ngStyle]="{'background-color': note.color}"></div>
                    <div style="display: flex; flex-direction: column; flex: 1; height: 100%;">
                      <div style="font-family: Roboto; font-size: 15px; margin-top: 10px; display: flex;">
                        <span style="display: flex; flex: 1; margin-left: 10px; font-weight: bold;">
                          {{note.title}}
                        </span>
                        <button mat-icon-button (click)="addNote()" style="width: 32px; height: 32px;">
                          <mat-icon style="margin-bottom: 8px;">clear</mat-icon>
                        </button>
                      </div>
                      <div class="simple-small-div" style="margin: 10px;"></div>
                      <div class="note-box-text" stylez="font-family: Muli; font-size: 18px">
                        {{note.content}}
                      </div>
                    </div>
                  </div>
                </div>
              </div> 

            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab label="Repas">
        <div class="tab-div">
          <div class="card full-width-card white no-margin">
            <div class="card-content black-text">
              <span class="card-title" style="margin-bottom: 0;">Liste des repas</span>
              <div class="simple-small-div" style="margin-bottom: 0;"></div>
              <table>
                <thead>
                  <tr>
                    <th style="width: 12%;">Date</th>
                    <th>Ingrédients</th>
                    <th style="width: 30%;">Description</th>
                    <th style="width: 15%;">Quantité de sucre</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let meal of userInfo.meals">
                    <td>{{this.timestampAsDate(meal.timestamp)}}</td>
                    <td>{{meal.ingredients}}</td>
                    <td>{{meal.description}}</td>
                    <td>{{meal.total_sugar.toFixed(2)}}g</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab label="Planning" disabled="true">
        <div class="tab-div">
          Planning goes here
        </div>
      </mat-tab>
      <mat-tab label="Prises de sang">
        <div class="tab-div">
          <div class="card mid-width white no-margin">
            <div class="card-content black-text">
              <div class="card-title" style="display: flex; margin-bottom: 6px;">
                <span style="flex-grow: 1; margin-top: 4px;">Hémoglobine Glyquée (HbA1C)</span>
                <a class="waves-effect waves-light btn topbar-button" style="margin-right: 5px;" (click)="addHb()">
                  <i class="material-icons left" style="margin-right: 10px;">add</i>
                  Ajouter une valeur
                </a>
              </div>
              <div class="simple-small-div"></div>
              <canvas baseChart #hbChart
                [datasets]="hbChartData"
                [labels]="hbChartLabels"
                [options]="hbChartOptions"
                [legend]="hbChartLegend"
                [chartType]="hbChartType">
              </canvas>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>